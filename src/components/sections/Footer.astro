---
import SmallSubtitle from "../ui/SmallSubtitle.astro";
import Subtitle from "../ui/Subtitle.astro";
import Link from "../ui/Link.astro";
import IconLink from "../ui/Icon.astro";
import Schedule from "../ui/Schedule.astro";
import { getOpeningHours } from "../../lib/api/scheduleapi";
import { groupOpeningHours } from "../../lib/utils/formatschedule";

import { FaInstagram, FaFacebook, FaTiktok, FaWhatsapp } from "react-icons/fa";

const contactData = {
  address: '5 Rue Dalou, 75015 Paris',
  phone: '+33 156 78 89 56',
  email: 'benoit@mail.com',
}

const links = [
  { text: 'Privacy Policy', href: '/privacy' },
  { text: 'Terms of Service', href: '/terms' },
  { text: 'About Us', href: '/about' },
  { text: 'Contact', href: '/contact' },
]

const socialLinks = [
  { iconName: 'instagram', href: 'https://instagram.com/example' },
  { iconName: 'facebook', href: 'https://facebook.com/example' },
  { iconName: 'whatsapp', href: 'https://wa.me/+1234567890' },
  { iconName: 'tiktok', href: 'https://tiktok.com/@example' },
]

const spotifyPlaylistId = "37i9dQZF1DX0XUsuxWHRQd";
const spotifyEmbedUrl = `https://open.spotify.com/embed/playlist/${spotifyPlaylistId}?utm_source=generator&theme=0`;
const whatsappNumber = "+4494340035";

const openingHoursData = await getOpeningHours();
const workingHours = groupOpeningHours(openingHoursData);
---

<div
  class:list={[
    'bg-black',
    'text-white',
    'py-16',
    'px-4',
    'relative',
    'overflow-hidden',
  ]}
>
  <div class:list={['flex', 'justify-center', 'mb-12']}>
    <div
      class:list={[
        'w-full',
        'max-w-5xl',
        'rounded-3xl',
        'overflow-hidden',
        'shadow-lg',
      ]}
    >
      <iframe
        title="Spotify Playlist"
        src={spotifyEmbedUrl}
        width='100%'
        height='360'
        allowfullscreen=''
        allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture'
        loading='lazy'
      ></iframe>
    </div>
  </div>
</div>

<footer
  class:list={[
    'bg-black text-white pt-45 px-4 relative overflow-hidden',
    'bg-brand-black',
  ]}
>
  <div class:list={['absolute inset-0 ', 'opacity-60']}>
    <img
      src='/images/moonscape-bg.png'
      alt='Moon landscape background'
      class:list={['w-full', 'h-full', 'object-cover']}
    />
  </div>

  <div class:list={['max-w-7xl', 'mx-auto', 'relative', 'z-10']}>
    <div
      class:list={[
        'grid',
        'grid-cols-1',
        'md:flex',
        'md:justify-between',
        'mb-12',
        'text-center',
        'md:text-left',
      ]}
    >
      <div class:list={['space-y-4']}>
        <SmallSubtitle
          iswhite={true}
          class:list={['text-center', 'md:text-left']}
        >
          CONTACT
        </SmallSubtitle>

        <div>
          <p class:list={["text-white", "mb-2"]}>{contactData.address}</p>
          <p class:list={["text-brand-orange", "mb-2"]}>
            Call - <Link href={`tel:${contactData.phone}`} openInNewTab={false}
              >{contactData.phone}</Link
            >
          </p>
          <p class:list={["text-brand-orange"]}>
            <Link href={`mailto:${contactData.email}`} openInNewTab={false}
              >{contactData.email}</Link
            >
          </p>
        </div>
        <div
          class:list={[
            "flex",
            "gap-3",
            "mt-4",
            "justify-center md:justify-start",
          ]}
        >
          {
            socialLinks.map((social) => (
              <IconLink href={social.href} openInNewTab={true}>
                {social.iconName === "instagram" && <FaInstagram client:load />}
                {social.iconName === "facebook" && <FaFacebook client:load />}
                {social.iconName === "whatsapp" && <FaWhatsapp client:load />}
                {social.iconName === "tiktok" && <FaTiktok client:load />}
              </IconLink>
            ))
          }
        </div>
      </div>

      <div class:list={['space-y-4']}>
        <Subtitle iswhite={true}><br /><br /><br />Moonhouse</Subtitle>
        <p class:list={['text-brand-white']}>Get news & offers events.</p>
      </div>

      <div class:list={['space-y-4']}>
        <Schedule
          title='WORKING HOURS'
          schedule={workingHours}
        />
      </div>
    </div>

    <div
      class:list={[
        'border-t',
        'border-brand-white',
        'pt-6',
        'text-center',
        'text-gray-400',
        'text-sm',
      ]}
    >
      {
        links.map((link) => (
          <Link
            href={link.href}
            openInNewTab={true}
          >
            {link.text}
          </Link>
        ))
      }
      <p>
        Â© 2025 Moonhouse. All rights reserved. |
        <Link
          href={`https://wa.me/${whatsappNumber}`}
          openInNewTab={true}
        >
          Developed by Dari Dev's Team
        </Link>
      </p>
    </div>
  </div>
</footer>
